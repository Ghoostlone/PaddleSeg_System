<template>
</template>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style type="text/css">
        html, body {
            margin: 0;
            height: 100%;
        }

        canvas {
            display: block;
        }

    </style>
    <div id="1" d="{{ply_path}}"></div>
</head>
<body>
</body>


<script type="module">
    import * as THREE from '../../static/three/build/three.module.js';
    import { OrbitControls } from '../../static/three/examples/jsm/controls/OrbitControls.js'
    import { PLYLoader } from '../../static/three/examples/jsm/loaders/PLYLoader.js'
    // 场景
		var scene = new THREE.Scene();
        var ply_path=document.getElementById(1).getAttribute('d');
        console.log(ply_path)
		// 摄像机
		var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
		camera.position.z = 5;

		// 渲染器
		var renderer = new THREE.WebGLRenderer();
		renderer.setSize( window.innerWidth, window.innerHeight );
		document.body.appendChild( renderer.domElement );
		// 渲染器 end

        // 光源
        var spotLight = new THREE.SpotLight( 0xffffff );
        spotLight.position.set( 40, 40, 40 );
        scene.add( spotLight );
        var spotLight2 = new THREE.SpotLight( 0xffffff );
        spotLight2.position.set( -40, -40, -40 );
        scene.add( spotLight2 );
        // 光源 end
        //辅助工具
        var helper = new THREE.AxesHelper(50);
        scene.add(helper);

		var loader = new PLYLoader();
        //处理路径传递
        var path1=ply_path+"niiEsophagus.ply";
        loader.load(path1, function (geometry) {

            //更新顶点的法向量
            // geometry.computeVertexNormals();
            geometry.translate(-200,-180,-100);
            //创建纹理，并将模型添加到场景道中
            var material = new THREE.MeshStandardMaterial( { color: 0x0055ff, flatShading: true } );
            var mesh = new THREE.Mesh( geometry, material );
            mesh.rotation.y = Math.PI;
            mesh.scale.set(0.05, 0.05, 0.05);
            scene.add( mesh );
        });
        loader.load("../../static/ply/niiA.ply", function (geometry) {

            //更新顶点的法向量
            // geometry.computeVertexNormals();
            geometry.translate(-200,-180,-100);
            //创建纹理，并将模型添加到场景道中
            var material = new THREE.MeshStandardMaterial( { color: 0xffffff, flatShading: true } );
            var mesh = new THREE.Mesh( geometry, material );
            mesh.rotation.y = Math.PI;
            mesh.scale.set(0.05, 0.05, 0.05);
            scene.add( mesh );
        });

        //用户交互插件 鼠标左键按住旋转，右键按住平移，滚轮缩放
        var controls;
        controls = new OrbitControls( camera, renderer.domElement );

        // 如果使用animate方法时，将此函数删除
        //controls.addEventListener( 'change', render );
        // 使动画循环使用时阻尼或自转 意思是否有惯性
        controls.enableDamping = true;
        //动态阻尼系数 就是鼠标拖拽旋转灵敏度
        //controls.dampingFactor = 0.25;
        //是否可以缩放
        controls.enableZoom = true;
        //是否自动旋转
        controls.autoRotate = false;
        controls.autoRotateSpeed = 0.5;
        //设置相机距离原点的最远距离
        controls.minDistance  = 0;
        //设置相机距离原点的最远距离
        controls.maxDistance  = 500;
        //是否开启右键拖拽
        controls.enablePan = true;
        function animate() {
        //更新控制器
        renderer.render( scene, camera );
        controls.update();
        requestAnimationFrame(animate);
    }
        animate()
</script>
</html>